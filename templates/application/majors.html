{% extends "application/formbase.html" %}

{% block extra-head %}
{{ block.super }}
<script type="text/javascript" src="{% load adm_media %}{% media_url %}/js/major_selection.js"></script>
{% endblock %}

{% block title %}Choosing majors{% endblock %}

{% block form-body %}
  {% if errors %}
    <div class="doc-error">
      <b>เกิดข้อผิดพลาด</b> {% for e in errors %}{{ e }}{% endfor %}
    </div>
  {% endif %}

  <p>
    <b>เลือกอันดับสาขาที่ต้องการ</b> สามารถเลือกอันดับสาขาวิชาได้ 6 อันดับ
    ไม่จำเป็นต้องเลือกให้ครบ 6 อันดับ แต่ต้องเลือกอย่างน้อยหนึ่งอันดับ
    ถ้าเลือกอันดับไม่ต่อกัน เช่น เลือกข้ามลำดับที่ 3 เมื่อเก็บเข้าในระบบ
    ระบบจะปรับลำดับให้ต่อเนื่องกันและเริ่มต้นจากอันดับที่ 1 เสมอ
  </p>

  <form action="{% url apply-majors %}" method="post">
    <table>
      {% for major, selected_rank in majors_prefs %}
        <tr>
	  <td>{{ major.number }}</td><td>{{ major.name }}</td>
	  <td>
	    {% include "application/include/major_rank_select.html" %}
	  </td>
	</tr>
      {% endfor %}
    </table>
    <div class="submission-bar">
      <input type="submit" name="submit" value="เก็บข้อมูล"/>
      <input type="submit" name="cancel" value="ยกเลิก"/>
    </div>
  </form>
  <script>
    $(document).ready(function() {
      MajorSelection.maxRank = {{ max_major_rank }};
      $("select").change(function() {
        if($(this).val()!="--")
          MajorSelection.shiftSelection(Number($(this).val()), this);
      });
    });
  </script>
{% endblock %}
