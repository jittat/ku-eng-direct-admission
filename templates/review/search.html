{% extends "review/base.html" %}

{% load adm_media %}

{% block extra-head %}
  {{ block.super }}
  <script type="text/javascript" src="{% load adm_media %}{% media_url %}/js/review.js"></script>
{% endblock %}

{% block regis-body %}
  {% if form %}
    <form action="{% url review-search %}" method="post">
      {{ form }}
      <input type="submit" name="search" value="ค้นข้อมูล"/>
    </form>
  {% endif %}

  {% if applicant_count %}
    <p>ผลลัพธ์ทั้งหมด {{ applicant_count }} รายการ แสดงผลแค่ 200 รายการแรก</p>
  {% endif %}

  <div class="small-vert-sept"></div>

  <table class="applicants">
    <tr>
      {% if display.ticket_number %}
        <th>หมายเลขผู้สมัคร</th>
      {% endif %}
      <th>ชื่อ</th>
      {% if display.edu %}<th>โรงเรียน</th>{% endif %}
      <th>สถานะการยื่นใบสมัคร</th>
      <th>วิธีการส่งหลักฐาน</th>
      {% if display.doc_reviewed_at %}<th>ตรวจเมื่อ</th>{% endif %}
      {% if display.doc_reviewed_at %}<th>ผลการตรวจ</th>{% endif %}
      {% if force_review_link %}
        <th></th>
      {% endif %}
    </tr>
    {% for applicant in applicants %}
      <tr id="app-{{ applicant.id }}-row" class="{% cycle 'odd' 'even' %}">
	{% if display.ticket_number %}
	  <td>{{ applicant.ticket_number }}</td>
	{% endif %}
	<td>{{ applicant.full_name }}</td>
	{% if display.edu %}
	  <td>{{ applicant.education.school_name }}</td>
        {% endif %}
	<td>{% if applicant.is_submitted %}ยื่นใบสมัครแล้ว{% else %}ยังไม่ยื่น{% endif %}</td>
	<td>{{ applicant.get_doc_submission_method_display }}</td>
	{% if display.doc_reviewed_at %}
	  <td>{{ applicant.submission_info.doc_reviewed_at|date:"H:i, j N" }}</td>
	{% endif %}
	{% if display.doc_reviewed_complete %}
	  <td>
	    {% passed_icon applicant.submission_info.doc_reviewed_complete  %}
	    {% if applicant.submission_info.doc_reviewed_complete %}ผ่าน{% else %}ไม่ผ่าน{% endif %}
	  </td>
	{% endif %}
	{% if force_review_link %}
	  <td>
            {% if applicant.submission_info.can_be_reviewed %}
              [<a href="{% url review-show applicant.id %}">ตรวจเอกสาร</a>]</td>
	    {% endif %}
	  </td>
        {% endif %}
      </tr>
    {% empty %}
      <tr><td colspan="7">ไม่พบผู้สมัคร</td></tr>
    {% endfor %}
  </table>

<script type="text/javascript">
  $(document).ready(function() {
    register_doc_recevied_toggle_click();
  });
</script>
{% endblock %}
